{
  "project": "tiny-cloak.nvim",
  "branchName": "ralph/tiny-cloak",
  "description": "A lightweight Neovim plugin that masks sensitive data (API keys, secrets, tokens) in .env, JSON, and YAML files",
  "userStories": [
    {
      "id": "US-001",
      "title": "Setup plugin structure",
      "description": "As a developer, I need the basic plugin structure so the plugin can be loaded by Neovim package managers.",
      "acceptanceCriteria": [
        "lua/tiny-cloak/init.lua exports a setup() function",
        "Default configuration is applied when setup() is called without arguments",
        "Plugin loads without errors: :lua require('tiny-cloak').setup()",
        "Typecheck passes (selene or lua-language-server)"
      ],
      "priority": 1,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Implement core cloaking engine with extmarks",
      "description": "As a developer, I need the core cloaking mechanism using Neovim's extmarks API.",
      "acceptanceCriteria": [
        "Create namespace via vim.api.nvim_create_namespace('tiny-cloak')",
        "Implement cloak_line(bufnr, line_num, start_col, end_col) function",
        "Use nvim_buf_set_extmark with virt_text and virt_text_pos='overlay'",
        "Cloak character repeats to match original text length",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Cloak .env files",
      "description": "As a user, I want API keys in .env files automatically masked so I don't accidentally expose them.",
      "acceptanceCriteria": [
        "Values matching patterns are cloaked: API_KEY, SECRET, PASSWORD, TOKEN, CREDENTIAL, AUTH",
        "Only the value portion is cloaked (key name remains visible)",
        "Example: API_KEY=sk-abc123 displays as API_KEY=**********",
        "Cloaking applies automatically when opening .env files",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Cloak JSON files",
      "description": "As a user, I want secrets in JSON files masked so config files are safe to display.",
      "acceptanceCriteria": [
        "String values for keys matching common patterns are cloaked (case-insensitive)",
        "Patterns: api_key, apiKey, secret, password, token, credential, auth",
        "Example: \"apiKey\": \"sk-abc123\" displays as \"apiKey\": \"**********\"",
        "Cloaking applies automatically when opening .json files",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Cloak YAML files",
      "description": "As a user, I want secrets in YAML files masked so config files are safe to display.",
      "acceptanceCriteria": [
        "String values for keys matching common patterns are cloaked (case-insensitive)",
        "Patterns: api_key, apiKey, secret, password, token, credential, auth",
        "Example: api_key: sk-abc123 displays as api_key: **********",
        "Cloaking applies automatically when opening .yaml and .yml files",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Auto-attach to buffers via autocommands",
      "description": "As a user, I want cloaking to apply automatically when I open matching files.",
      "acceptanceCriteria": [
        "Create autocommand group 'TinyCloak'",
        "Attach on BufEnter and BufRead for patterns: .env*, *.json, *.yaml, *.yml",
        "Re-apply cloaking on TextChanged and TextChangedI events",
        "Clear extmarks before re-applying to avoid duplicates",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Implement CloakToggle command",
      "description": "As a user, I want to toggle cloaking on/off so I can temporarily view actual values.",
      "acceptanceCriteria": [
        ":CloakToggle command toggles cloaking state globally",
        "When disabled, all extmarks are cleared from all buffers",
        "When re-enabled, cloaking is re-applied to all matching buffers",
        "State persists until toggled again or Neovim restarts",
        "Typecheck passes"
      ],
      "priority": 7,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-008",
      "title": "Implement CloakEnable and CloakDisable commands",
      "description": "As a user, I want explicit enable/disable commands for scripting and keymaps.",
      "acceptanceCriteria": [
        ":CloakEnable enables cloaking (no-op if already enabled)",
        ":CloakDisable disables cloaking (no-op if already disabled)",
        "Commands work from any buffer",
        "Typecheck passes"
      ],
      "priority": 8,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-009",
      "title": "Configurable cloak character",
      "description": "As a user, I want to customize the masking character to match my preferences.",
      "acceptanceCriteria": [
        "setup({ cloak_character = '•' }) uses '•' instead of '*'",
        "Default cloak character is '*'",
        "Character is used in all extmark overlays",
        "Typecheck passes"
      ],
      "priority": 9,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-010",
      "title": "Configurable file patterns",
      "description": "As a user, I want to add custom file patterns to cloak additional file types.",
      "acceptanceCriteria": [
        "setup({ file_patterns = { '.env*', '*.json', '*.yaml', '*.yml' } }) configures patterns",
        "Patterns use Neovim autocommand glob syntax",
        "Default patterns cover .env, .env.*, *.json, *.yaml, *.yml",
        "Typecheck passes"
      ],
      "priority": 10,
      "passes": false,
      "notes": ""
    }
  ]
}
